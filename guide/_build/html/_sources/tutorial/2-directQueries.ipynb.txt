{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Direct queries over data"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Some directec queries can be made directly over the dataframe without recurring to special functions or code."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "## Load the data\n",
    "records = pd.read_json('demo-keywords.json', orient='records', lines=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "156"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "##\n",
    "## Number of records in the dataframe\n",
    "##\n",
    "len(records)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "107"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "##\n",
    "## Number of sources\n",
    "##\n",
    "len(records['Source title'].unique())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Title</th>\n",
       "      <th>Authors</th>\n",
       "      <th>Year</th>\n",
       "      <th>Cited by</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>119</th>\n",
       "      <td>Rise of the machines: Algorithmic trading in t...</td>\n",
       "      <td>Chaboud A.P., Chiquoine B., Hjalmarsson E., Ve...</td>\n",
       "      <td>2014</td>\n",
       "      <td>105</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66</th>\n",
       "      <td>The Penn-Lehman Automated Trading Project</td>\n",
       "      <td>Kearns M., Ortiz L.</td>\n",
       "      <td>2003</td>\n",
       "      <td>49</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125</th>\n",
       "      <td>Application of evolutionary computation for ru...</td>\n",
       "      <td>Hu Y., Liu K., Zhang X., Su L., Ngai E.W.T., L...</td>\n",
       "      <td>2015</td>\n",
       "      <td>45</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>115</th>\n",
       "      <td>Automated trading with performance weighted ra...</td>\n",
       "      <td>Booth A., Gerding E., McGroarty F.</td>\n",
       "      <td>2014</td>\n",
       "      <td>38</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>82</th>\n",
       "      <td>Automated trading with boosting and expert wei...</td>\n",
       "      <td>Creamer G., Freund Y.</td>\n",
       "      <td>2010</td>\n",
       "      <td>31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>89</th>\n",
       "      <td>Intra-daily volume modeling and prediction for...</td>\n",
       "      <td>Brownlees C.T., Cipollini F., Gallo G.M.</td>\n",
       "      <td>2011</td>\n",
       "      <td>29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>79</th>\n",
       "      <td>Flexible least squares for temporal data minin...</td>\n",
       "      <td>Montana G., Triantafyllopoulos K., Tsagaris T.</td>\n",
       "      <td>2009</td>\n",
       "      <td>23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>134</th>\n",
       "      <td>Robust technical trading strategies using GP f...</td>\n",
       "      <td>Berutich J.M., López F., Luna F., Quintana D.</td>\n",
       "      <td>2016</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Algorithmic trading review</td>\n",
       "      <td>Treleaven P., Galas M., Lalchand V.</td>\n",
       "      <td>2013</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>108</th>\n",
       "      <td>Portfolio of automated trading systems: Comple...</td>\n",
       "      <td>Raudys S.</td>\n",
       "      <td>2013</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                 Title  \\\n",
       "119  Rise of the machines: Algorithmic trading in t...   \n",
       "66           The Penn-Lehman Automated Trading Project   \n",
       "125  Application of evolutionary computation for ru...   \n",
       "115  Automated trading with performance weighted ra...   \n",
       "82   Automated trading with boosting and expert wei...   \n",
       "89   Intra-daily volume modeling and prediction for...   \n",
       "79   Flexible least squares for temporal data minin...   \n",
       "134  Robust technical trading strategies using GP f...   \n",
       "16                          Algorithmic trading review   \n",
       "108  Portfolio of automated trading systems: Comple...   \n",
       "\n",
       "                                               Authors  Year  Cited by  \n",
       "119  Chaboud A.P., Chiquoine B., Hjalmarsson E., Ve...  2014       105  \n",
       "66                                 Kearns M., Ortiz L.  2003        49  \n",
       "125  Hu Y., Liu K., Zhang X., Su L., Ngai E.W.T., L...  2015        45  \n",
       "115                 Booth A., Gerding E., McGroarty F.  2014        38  \n",
       "82                               Creamer G., Freund Y.  2010        31  \n",
       "89            Brownlees C.T., Cipollini F., Gallo G.M.  2011        29  \n",
       "79      Montana G., Triantafyllopoulos K., Tsagaris T.  2009        23  \n",
       "134      Berutich J.M., López F., Luna F., Quintana D.  2016        21  \n",
       "16                 Treleaven P., Galas M., Lalchand V.  2013        20  \n",
       "108                                          Raudys S.  2013        20  "
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "##\n",
    "## Ten most cited documents\n",
    "##\n",
    "records.sort_values(by='Cited by', ascending=False)[['Title', 'Authors', 'Year', 'Cited by']][0:10]"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
